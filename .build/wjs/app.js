var hd={param:{},shareObj:null,isShared:!1,data:null,initRenderData:function(e){},getCodeStatus:function(e,t,n){var r="未中奖";if(e==1)if(n&&n.length>0)for(var i=0;i<n.length;i++)Number(t)===Number(n[i])&&(r="恭喜中奖");else r="未中奖";else r="未开奖";return r},init:function(){hd.param.id=initData.id,hd.param.openid=initData.openid,hd.param.phone=initData.phone,$("#change").on("click",function(e){e.preventDefault(),hd.showMobInput(hd.param.phone);return}),$("#share").on("click",function(){hd.pop=Pop.set({contentId:"popShare",content:'<div class="shareContent"></div><div class="shareClose"></div>',btns:{".shareClose":function(e){hd.pop.hide(),hd.pop=null}}}).show(),_paq.push(["trackEvent","分享","click",hd.param.id])}),$("#open").on("click",function(){_paq.push(["trackEvent","下载","click",hd.param.id])}),setTimeout(function(){$(".wrapper").show(),$(".loading").hide()},100),data.getShareConfig(hd.param,hd.getShareConfigBack)},formatCode:function(e){var t=e;for(var n=0;n<8-e.length;n++)t="0"+t;return t},showMobInput:function(e){hd.pop=Pop.set({content:'<div class="mobInput"><div class="mobTxt">当前抽奖手机号：<span>'+e+'</span></div><input id="mobNum" type="tel" placeholder="请输入新的手机号码" maxlength="11"><div id="errMsg">您输入的手机号码有误</div><button id="mobConfirm">确定</button></div><div class="mobClose"></div>',btns:{"#mobConfirm":function(e){hd.handleMob(e)},".mobClose":function(e){hd.pop.hide(),hd.pop=null}}}).show()},handleMob:function(e){var t=$(e.target),n=t.parent().find("#mobNum");hd.param.phone=n.val().replace(/[^\d]/g,"").slice(0,11);if(hd.param.phone==""||!com.isPhoneNum(hd.param.phone))return $("#errMsg").css("visibility","visible"),!1;$("#errMsg").css("visibility","hidden"),data.updatePhone(hd.param,hd.updateBack)},updateBack:function(e){e.result&&e.status&&!e.status.code?hd.pop.hide():$("#errMsg").text("服务器休息一会，请下次再试~").css("visibility","visible")},getShareConfigBack:function(e){e.result&&e.status&&!e.status.code&&(hd.shareObj=e.result)},doShareBack:function(e){if(e.result&&e.status&&!e.status.code){var t=$("#prizeListDest");for(var n=0;n<e.result.length;n++)t.html(t.html()+'<p class="prize-item">'+e.result[n].formatCode+" <span>(未开奖)</span></p>");hd.isShared=!0,$("#share").text("分享给好友"),_paq.push(["trackEvent","分享成功","click",hd.param.id])}},shareFriend:function(){hd.shareObj&&WeixinJSBridge.invoke("sendAppMessage",{appid:"wx11893ccc398396db",img_url:hd.shareObj.imgUrl,img_width:"256",img_height:"256",link:hd.shareObj.url,desc:hd.shareObj.content,title:hd.shareObj.title},function(e){/\:(confirm|ok)/i.test(e.err_msg)&&(hd.isShared||(data.doShare(hd.param,hd.doShareBack),hd.isShared=!0))})},shareTimeline:function(){hd.shareObj&&WeixinJSBridge.invoke("shareTimeline",{img_url:hd.shareObj.imgUrl,img_width:"640",img_height:"640",link:hd.shareObj.url,desc:hd.shareObj.content,title:hd.shareObj.title},function(e){/\:(confirm|ok)/i.test(e.err_msg)&&(hd.isShared||(data.doShare(hd.param,hd.doShareBack),hd.isShared=!0))})}};$(document).ready(function(){hd.init()}),document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.on("menu:share:appmessage",function(e){hd.shareFriend()}),WeixinJSBridge.on("menu:share:timeline",function(e){hd.shareTimeline()})},!1),define("app",function(){});